# API Key 管理

## 三方自助申请 API Key

不对外暴露，必须由内部模块发起。

提交申请后，需平台方审核通过，才能获得 API Key

`POST /api/v1/api-key/request`

**请求参数**

| **参数**     | **是否必须** | **类型** | **说明**                                            |
| ------------ | ------------ | -------- | --------------------------------------------------- |
| restrictions | false        | int      | 新建 API Key 权限 0 = 所有权限（All）；默认所有权限 |
| email        | true         | string   | 邮箱                                                |
| name         | true         | string   | 名称                                                |

**返回参数**

| **参数**     | **类型** | **说明**                                                                                                      |
| ------------ | -------- | ------------------------------------------------------------------------------------------------------------- |
| apiKey       | string   | API Key                                                                                                       |
| apiSecret    | string   | API 密钥(只在申请时返回一次，无法通过接口查询，所有 api 接口需要通过此 key 来加密，请妥善保管，不展示与其他人 |
| restrictions | int      | API Key 拥有权限                                                                                              |
| status       | int      | API Key 状态，0（申请中）、-1（关闭）、1（使用中）                                                            |

## 三方自助 API Key 状态查询

查询 API Key 是否可用

`POST /api/v1/api-key/info`

**请求参数**

| 参数   | 是否必须 | 类型   | **说明** |
| ------ | -------- | ------ | -------- |
| apiKey | true     | string | API Key  |

**返回参数**

| **参数**   | **类型** | **说明**                                           |
| ---------- | -------- | -------------------------------------------------- |
| status     | int      | API Key 状态，0（申请中）、-1（关闭）、1（使用中） |
| name       | string   |                                                    |
| email      | string   |                                                    |
| permission | int      |                                                    |

## 三方自助 API 密钥重新生成

因密钥泄露或者其他原因，需要重新生成握手密钥

` POST /api/v1/api-key/re-gen-sec`

**请求参数**

| 参数   | 是否必须 | 类型   | **说明** |
| ------ | -------- | ------ | -------- |
| apiKey | true     | string | API Key  |

**返回参数**

| **参数**  | **类型** | **说明** |
| --------- | -------- | -------- |
| apiSecret | string   |          |

## 平台批准 API 申请

由平台管理员批准，并且可以重置权限和状态

` POST /api/v1/api-key/approve`

**请求参数**

| 参数       | 是否必须 | 类型   | **说明** |
| ---------- | -------- | ------ | -------- |
| apiKey     | true     | string | API Key  |
| permission | true     | int    |          |
| status     | true     | int    |          |

**返回参数**

| **参数** | **类型** | **说明** |
| -------- | -------- | -------- |
|          | string   |          |

## 平台暂停三方 API 功能

由平台管理员操作，禁用三方，置其状态为-1

` POST /api/v1/api-key/disable`

**请求参数**

| 参数   | 是否必须 | 类型   | **说明** |
| ------ | -------- | ------ | -------- |
| apiKey | true     | string | API Key  |

**返回参数**

| **参数** | **类型** | **说明** |
| -------- | -------- | -------- |
|          | string   |          |

## 平台重启三方 API 功能

由平台管理员操作，重启三方，置其状态为 1。如果不修改三方权限，可用此方法代替 Approve

` POST /api/v1/api-key/enable`

**请求参数**

| 参数   | 是否必须 | 类型   | **说明** |
| ------ | -------- | ------ | -------- |
| apiKey | true     | string | API Key  |

**返回参数**

| **参数** | **类型** | **说明** |
| -------- | -------- | -------- |
|          | string   |          |

## 平台列表 api 请求

由平台管理员操作，查询 apiKey

` POST /api/v1/api-key/list`

**请求参数**

| **参数** | **是否必须** | **类型**  | **说明**     |
| -------- | ------------ | --------- | ------------ |
| start    | true         | timestamp | 秒级时间戳   |
| end      | true         | timestamp | 秒级时间戳   |
| page     | false        | int       | 第几页       |
| limit    | false        | int       | 页面行数     |
| status   | false        | int       | -99 代表全部 |

**返回参数**
对象列表

| **参数**   | **类型** | **说明** |
| ---------- | -------- | -------- |
| apiKey     | string   |          |
| permission | int      |          |
| status     | int      |          |
| name       | string   |          |
| email      | string   |          |
| createdAt  | time     | 申请时间 |
